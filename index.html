<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="style.css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
</script>
<script>
var tab = new Array();
var statusTab = new Array();
var ileKlik = 0;
var lastKlik =0;

function initMem()
{
var upPom=$("#ilesl").val();
tab.length=0;
statusTab.length=0;
ileKlik = 0;
lastKlik =0;

for(var i=0;i<upPom;i++)
{
tab.push(-1);
statusTab.push(0);
}

for(var i=0;i<upPom/2;i++)
{
for(var j=0;j<2;j++)
{
do
{
var ranLos = Math.round(Math.random() * upPom);
}
while(tab[ranLos]!=-1)
tab[ranLos]=i;
}
}
/*
$.each(tab,function(){
$("#obszar table").append($("<div></div>").addClass("puzel")
.attr('name',this));
});
*/
var iloscWierszy=Math.floor(Math.sqrt(upPom));
for(var i=0;i<iloscWierszy;i++)
{
var pom = $("#obszar table");
var pRow=$("<tr></tr>");
for(var j=0;j<Math.ceil(upPom/iloscWierszy);j++){
if( (i*Math.ceil(upPom/iloscWierszy)+j) < upPom ){
pRow.append($("<td></td>"))
.append($("<div></div>").addClass("puzel").attr('name',(i*Math.ceil(upPom/iloscWierszy))+j));
}
}
pom.append(pRow);
}
//alert(tab);
} //initMem

function rysuj()
{
$.each($(".puzel"),function(){
	var inx = parseInt($(this).attr("name"));
	if(statusTab[inx]==1)
	{
	var name1 = 'url(./image/i'+tab[inx]+'.svg) no-repeat center center, rgba(255,180,0,0.8)';
    	$(this).css('background',name1).css('background-size','80%, 100%');
	} else if(statusTab[inx]==2){
	var name1 = 'url(./image/i'+tab[inx]+'.svg) no-repeat center center, rgba(255,180,0,0.8)';
    	$(this).css('background',name1).css('background-size','80%, 100%');
	} else if(statusTab[inx]==0) {
	var name1 = 'url(./image/i_back_t.jpg) no-repeat';
    	$(this).css('background',name1).css('background-size','100%');
	}
});
}//rysuj

$(document).ready(function(){
  
  $("#ustawienia").click(function(){
    $("#ustpanel").slideToggle();
  });
  $("#ilesl").change(function(){
    $("#slil").text($("#ilesl").val());
  });
  $("#start").click(function(){
    $("#obszar table").empty();
    initMem();
  });
});

$(document).on( "click", ".puzel", function(){
	//alert($(this).attr("name"));
	var inx = parseInt($(this).attr("name"));
	//var name1 = 'url(./image/i'+tab[inx]+'.svg) no-repeat center center, rgba(255,180,0,0.8)';
    //$(this).css('background',name1).css('background-size','80%, 100%');
	ileKlik++;
	if(ileKlik==1){
	statusTab[inx]=1;
	lastKlik = inx;
	rysuj();
	} else if(ileKlik==2){
	if(tab[lastKlik]==tab[inx] && inx!=lastKlik){
	statusTab[lastKlik]=2;
	statusTab[inx]=2;
	rysuj();
	} else {
	statusTab[inx]=1;
	rysuj();
	statusTab[lastKlik]=0;
	statusTab[inx]=0;
	setTimeout(function()
    	{rysuj();}, 2000);
	
	}
	ileKlik=0;
	}
	//alert(statusTab);
});


</script>
<title>Memory - sprawdŸ swoj¹ pamiêæ !</title>
<meta charset="windows-1250">
</head>
<body>

<div id="obszar">
<table>
</table>
</div>

<div id="nav">
<button id="start">Start</button>
</div>

<div id="ustawienia">
<p>Ustawienia</p>
</div>
<div id="ustpanel">
<p>Wielkoœæ planszy: 
<input type="range" id="ilesl" min="4" max="20" step="2" value="4">
<span id="slil">4</span>
</p>

</div>
<div id="ustpanel">
<p>
<input type="radio" name="wielkosc">ma³a</input>
</p>
</div>

</body>
</html>